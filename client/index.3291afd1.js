import{S as t,i as e,s as a,e as s,t as i,c as n,b as c,d as o,f as r,h as l,L as h,k as d,l as u,y as f,a as g,g as v,n as w,M as b,I as m,N as p,O as I}from"./index.f67fa270.js";import"./index.0833934d.js";class C{constructor(){this.accelerometer={x:0,y:0,z:0},this.magnetometer_raw={x:0,y:0,z:0},this.magnetometer_bearing=0,this.temperature=0,this.buttonA=0,this.buttonACallBack=function(){},this.buttonB=0,this.buttonBCallBack=function(){},this.connected=!1,this.onConnectCallback=function(){},this.onDisconnectCallback=function(){},this.onBLENotifyCallback=function(){},this.characteristic={IO_PIN_DATA:{},IO_AD_CONFIG:{},IO_PIN_CONFIG:{},IO_PIN_PWM:{},LED_STATE:{},LED_TEXT:{},LED_SCROLL:{}}}getTemperature(){return this.temperature}getAccelerometer(){return this.accelerometer}getBearing(){return this.magnetometer_bearing}getButtonA(){return this.buttonA}setButtonACallback(t){this.buttonACallBack=t}getButtonB(){return this.buttonB}setButtonBCallback(t){this.buttonBCallBack=t}onConnect(t){this.onConnectCallback=t}onDisconnect(t){this.onDisconnectCallback=t}onBleNotify(t){this.onBLENotifyCallback=t}writePin(t){}readPin(t){}writeMatrixIcon(t){for(var e=new Int8Array(5),a=[["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"]],s=0;s<5;s++)for(var i=0;i<5;i++)a[s][7-i]=t[s][4-i];for(s=0;s<5;s++){var n=a[s].join("");e[s]=parseInt(n,2)}this.connected&&this.characteristic.LED_STATE.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}writeMatrixTextSpeed(t){var e=new Uint8Array(t);this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}writeMatrixText(t){var e=new Uint8Array(function(t){for(var e=[],a=0;a<t.length;a++){var s=t.charCodeAt(a);s<128?e.push(s):s<2048?e.push(192|s>>6,128|63&s):s<55296||s>=57344?e.push(224|s>>12,128|s>>6&63,128|63&s):(a++,s=65536+((1023&s)<<10|1023&t.charCodeAt(a)),e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|63&s))}return e}(t));this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}onButtonA(){this.buttonACallBack()}onButtonB(){this.buttonBCallBack()}characteristic_updated(t){this.onBLENotifyCallback(),"e95dda90-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.buttonA=t.target.value.getInt8(),this.buttonA&&this.onButtonA()),"e95dda91-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.buttonB=t.target.value.getInt8(),this.buttonB&&this.onButtonB()),"e95dca4b-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.accelerometer.x=t.target.value.getInt16(0,!0),this.accelerometer.y=t.target.value.getInt16(2,!0),this.accelerometer.z=t.target.value.getInt16(4,!0)),"e95dfb11-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.magnetometer_raw.x=t.target.value.getInt16(0,!0),this.magnetometer_raw.y=t.target.value.getInt16(2,!0),this.magnetometer_raw.z=t.target.value.getInt16(4,!0)),"e95d9715-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.magnetometer_bearing=t.target.value.getInt16(0,!0)),"e95d9250-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.temperature=t.target.value.getInt8())}searchDevice(){var t={acceptAllDevices:!0,optionalServices:["e95d0753-251d-470a-a062-fa1922dfa9a8","e95df2d8-251d-470a-a062-fa1922dfa9a8","e95d9882-251d-470a-a062-fa1922dfa9a8","e95d127b-251d-470a-a062-fa1922dfa9a8","e95dd91d-251d-470a-a062-fa1922dfa9a8","e95d6100-251d-470a-a062-fa1922dfa9a8"]};console.log("Requesting Bluetooth Device..."),console.log("with "+JSON.stringify(t)),navigator.bluetooth.requestDevice(t).then(t=>(console.log("> Name:             "+t.name),console.log("> Id:               "+t.id),t.addEventListener("gattserverdisconnected",this.onDisconnectCallback),t.gatt.connect())).then(t=>(this.onConnectCallback(),console.log("Getting Services..."),t.getPrimaryServices())).then(t=>{console.log("Getting Characteristics...");let e=Promise.resolve();return t.forEach(t=>{e=e.then(e=>t.getCharacteristics().then(e=>{console.log("> Service: "+t.uuid),e.forEach(t=>{switch(console.log(">> Characteristic: "+t.uuid+" "+E(t)),t.uuid){case"e95d8d00-251d-470a-a062-fa1922dfa9a8":this.characteristic.IO_PIN_DATA=t;break;case"e95d5899-251d-470a-a062-fa1922dfa9a8":this.characteristic.IO_AD_CONFIG=t;break;case"e95db9fe-251d-470a-a062-fa1922dfa9a8":this.characteristic.IO_PIN_CONFIG=t;break;case"e95dd822-251d-470a-a062-fa1922dfa9a8":this.characteristic.IO_PIN_PWM=t;break;case"e95d7b77-251d-470a-a062-fa1922dfa9a8":this.characteristic.LED_STATE=t,this.connected=!0;break;case"e95d93ee-251d-470a-a062-fa1922dfa9a8":this.characteristic.LED_TEXT=t;break;case"e95d0d2d-251d-470a-a062-fa1922dfa9a8":this.characteristic.LED_SCROLL=t}E(t).includes("NOTIFY")&&(t.startNotifications().catch(t=>console.log("startNotifications",t)),t.addEventListener("characteristicvaluechanged",this.characteristic_updated.bind(this)))})}))}),e}).catch(t=>{console.log("Argh! "+t)})}}function E(t){let e=[];for(const a in t.properties)!0===t.properties[a]&&e.push(a.toUpperCase());return"["+e.join(", ")+"]"}class B{constructor(t){this.context=t,this.pausedSize=1,this.axisSize=3}draw_line(t,e,a,s){this.context.strokeStyle=s,this.context.lineWidth=a,this.context.lineCap="round",this.context.lineTo(t,e),this.context.stroke(),this.context.beginPath(),this.context.moveTo(t,e)}draw_point(t,e,a,s){this.context.fillStyle=s,this.context.fillRect(t,e,this.pausedSize,this.pausedSize)}draw_axis(t,e,a,s){this.context.fillStyle="black",this.context.fillRect(0,0,a,s),this.context.fillStyle="yellow",this.context.fillRect(t,e,this.axisSize,this.axisSize)}mapValues(t,e,a,s,i){return(t-e)/(a-e)*(i-s)+s}}const{document:_,window:x}=p;function A(t){let e,a,g,v,w=(t[1]?t[9][1]:t[9][0])+"";return{c(){e=s("div"),a=s("button"),g=i(w),this.h()},l(t){e=n(t,"DIV",{class:!0});var s=c(e);a=n(s,"BUTTON",{class:!0});var i=c(a);g=o(i,w),i.forEach(r),s.forEach(r),this.h()},h(){l(a,"class","btn svelte-15wwbf5"),l(e,"class","svelte-15wwbf5"),v=h(a,"click",t[10])},m(t,s){d(t,e,s),u(e,a),u(a,g)},p(t,e){2&e&&w!==(w=(t[1]?t[9][1]:t[9][0])+"")&&f(g,w)},d(t){t&&r(e),v()}}}function k(t){let e,a;return{c(){e=s("button"),a=i("draw"),this.h()},l(t){e=n(t,"BUTTON",{class:!0});var s=c(e);a=o(s,"draw"),s.forEach(r),this.h()},h(){l(e,"class","btn-menu svelte-15wwbf5")},m(t,s){d(t,e,s),u(e,a)},p:w,d(t){t&&r(e)}}}function T(t){let e,a,h=""===t[8]?"line":"dot";return{c(){e=s("button"),a=i(h),this.h()},l(t){e=n(t,"BUTTON",{class:!0});var s=c(e);a=o(s,h),s.forEach(r),this.h()},h(){l(e,"class","btn-menu svelte-15wwbf5")},m(t,s){d(t,e,s),u(e,a)},p(t,e){256&e&&h!==(h=""===t[8]?"line":"dot")&&f(a,h)},d(t){t&&r(e)}}}function D(t){let e,a,m,p,I,C,E,B,D,P,L,y,S,N,O,V,z,R,U,F,G,M,W,j,q,X,Z,H,Q,J,Y,K,$=t[0]&&A(t);function tt(t,e){return t[8]?T:k}let et=tt(t),at=et(t);return{c(){e=g(),a=s("div"),m=s("h1"),p=i("LZRBIT"),I=g(),$&&$.c(),C=g(),E=s("div"),B=s("div"),at.c(),D=g(),P=s("p"),L=i("x: "),y=i(t[5]),S=g(),N=s("p"),O=i("y: "),V=i(t[6]),z=g(),R=s("p"),U=i("z: "),F=i(t[7]),G=g(),M=s("button"),W=i("save"),j=g(),q=s("div"),X=s("canvas"),Z=g(),H=s("div"),Q=s("div"),J=i("[!] press Q to draw lines | press W to draw points | press SPACE to reset [!]"),this.h()},l(s){e=v(s),a=n(s,"DIV",{class:!0});var i=c(a);m=n(i,"H1",{class:!0});var l=c(m);p=o(l,"LZRBIT"),l.forEach(r),I=v(i),$&&$.l(i),C=v(i),E=n(i,"DIV",{class:!0});var h=c(E);B=n(h,"DIV",{class:!0});var d=c(B);at.l(d),D=v(d),P=n(d,"P",{class:!0});var u=c(P);L=o(u,"x: "),y=o(u,t[5]),u.forEach(r),S=v(d),N=n(d,"P",{class:!0});var f=c(N);O=o(f,"y: "),V=o(f,t[6]),f.forEach(r),z=v(d),R=n(d,"P",{class:!0});var g=c(R);U=o(g,"z: "),F=o(g,t[7]),g.forEach(r),G=v(d),M=n(d,"BUTTON",{class:!0});var w=c(M);W=o(w,"save"),w.forEach(r),d.forEach(r),h.forEach(r),j=v(i),q=n(i,"DIV",{hidden:!0,class:!0});var b=c(q);X=n(b,"CANVAS",{width:!0,height:!0,class:!0}),c(X).forEach(r),Z=v(b),H=n(b,"DIV",{class:!0});var _=c(H);Q=n(_,"DIV",{class:!0});var x=c(Q);J=o(x,"[!] press Q to draw lines | press W to draw points | press SPACE to reset [!]"),x.forEach(r),_.forEach(r),b.forEach(r),i.forEach(r),this.h()},h(){_.title="LZRBTI-APP",l(m,"class","svelte-15wwbf5"),l(P,"class","svelte-15wwbf5"),l(N,"class","svelte-15wwbf5"),l(R,"class","svelte-15wwbf5"),l(M,"class","btn-menu svelte-15wwbf5"),l(B,"class","grid-container svelte-15wwbf5"),l(E,"class","flex-container svelte-15wwbf5"),l(X,"width",t[3]),l(X,"height",t[4]),l(X,"class","svelte-15wwbf5"),l(Q,"class","svelte-15wwbf5"),l(H,"class","flex-container svelte-15wwbf5"),q.hidden=Y=!t[1],l(q,"class","svelte-15wwbf5"),l(a,"class","flex-container svelte-15wwbf5"),K=[h(x,"keydown",t[12]),h(M,"click",t[11])]},m(s,i){d(s,e,i),d(s,a,i),u(a,m),u(m,p),u(a,I),$&&$.m(a,null),u(a,C),u(a,E),u(E,B),at.m(B,null),u(B,D),u(B,P),u(P,L),u(P,y),u(B,S),u(B,N),u(N,O),u(N,V),u(B,z),u(B,R),u(R,U),u(R,F),u(B,G),u(B,M),u(M,W),u(a,j),u(a,q),u(q,X),t[17](X),u(q,Z),u(q,H),u(H,Q),u(Q,J)},p(t,[e]){t[0]?$?$.p(t,e):($=A(t),$.c(),$.m(a,C)):$&&($.d(1),$=null),et===(et=tt(t))&&at?at.p(t,e):(at.d(1),at=et(t),at&&(at.c(),at.m(B,D))),32&e&&f(y,t[5]),64&e&&f(V,t[6]),128&e&&f(F,t[7]),8&e&&l(X,"width",t[3]),16&e&&l(X,"height",t[4]),2&e&&Y!==(Y=!t[1])&&(q.hidden=Y)},i:w,o:w,d(s){s&&r(e),s&&r(a),$&&$.d(),at.d(),t[17](null),b(K)}}}function P(t,e,a){let s,i,n,c,o,r,l=!0,h=!1,d=new C,u=0,f=0,g=0,v={name:"Brush Parameters",sizeLine:.1,colorLine:"#9acd32",sizePoint:.1,colorPoint:"#ff6347"};return m(()=>{import("./dat.gui.module.83faae46.js").then(t=>{let e=new t.GUI;e.closed=!0;e.addFolder("Line");e.add(v,"sizeLine",0,1,.1),e.addColor(v,"colorLine");e.addFolder("Point");e.add(v,"sizePoint",0,2,.1),e.addColor(v,"colorPoint")}),a(3,n=window.innerWidth),a(4,c=window.innerHeight),i=s.getContext("2d");let t=new B(i);i.imageSmoothingEnabled=!0,function e(){if(i.globalCompositeOperation="lighter",h)if("q"===r){i.fillStyle="black",i.fillRect(0,0,n,c);let e=t.mapValues(u,-1024,1024,0,n),a=t.mapValues(f,-1024,1024,0,c);t.draw_line(e,a,v.sizeLine,v.colorLine)}else if("w"===r){i.fillStyle="black",i.fillRect(0,0,n,c);let e=t.mapValues(u,-1024,1024,0,n),a=t.mapValues(f,-1024,1024,0,c);t.draw_point(e,a,v.sizePoint,v.colorPoint),i.beginPath()}else if(" "===r){i.clearRect(0,0,n,c);let e=t.mapValues(u,-1024,1024,0,n),a=t.mapValues(f,-1024,1024,0,c);t.draw_axis(e,a,n,c)}else{i.clearRect(0,0,n,c);let e=t.mapValues(u,-1024,1024,0,n),a=t.mapValues(f,-1024,1024,0,c);t.draw_axis(e,a,n,c)}o=requestAnimationFrame(e)}()}),[l,h,s,n,c,u,f,g,r,["PAIR MICROBIT","PAIRED"],function(){d.searchDevice(),d.onConnect(()=>{console.log("connected"),a(1,h=!0),console.log("pared: true")}),d.onBleNotify((function(){a(5,u=d.getAccelerometer().x),a(6,f=d.getAccelerometer().y),a(7,g=d.getAccelerometer().z)})),a(0,l=!1)},function(){console.log("saveDrawing");const t=document.createElement("a");document.body.appendChild(t),t.href=s.toDataURL("image/png",1),t.download="canvas-image.png",t.click(),document.body.removeChild(t)},function(t){a(8,r=t.key)},i,o,d,v,function(t){I[t?"unshift":"push"](()=>{a(2,s=t)})}]}export default class extends t{constructor(t){super(),e(this,t,P,D,a,{})}}
