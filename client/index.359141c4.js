import{S as t,i as e,s as a,e as s,t as c,c as n,b as i,d as o,f as r,h as l,L as h,k as d,l as u,y as f,a as g,g as v,n as m,M as b,I as p,N as k,O as I}from"./index.f67fa270.js";import"./index.0833934d.js";var C="e95d0753-251d-470a-a062-fa1922dfa9a8",B="e95dca4b-251d-470a-a062-fa1922dfa9a8",E="e95df2d8-251d-470a-a062-fa1922dfa9a8",_="e95dfb11-251d-470a-a062-fa1922dfa9a8",A="e95d9715-251d-470a-a062-fa1922dfa9a8",w="e95d9882-251d-470a-a062-fa1922dfa9a8",T="e95dda90-251d-470a-a062-fa1922dfa9a8",q="e95dda91-251d-470a-a062-fa1922dfa9a8",D="e95d127b-251d-470a-a062-fa1922dfa9a8",x="e95d8d00-251d-470a-a062-fa1922dfa9a8",y="e95d5899-251d-470a-a062-fa1922dfa9a8",N="e95db9fe-251d-470a-a062-fa1922dfa9a8",z="e95dd822-251d-470a-a062-fa1922dfa9a8",L="e95dd91d-251d-470a-a062-fa1922dfa9a8",O="e95d7b77-251d-470a-a062-fa1922dfa9a8",P="e95d93ee-251d-470a-a062-fa1922dfa9a8",S="e95d0d2d-251d-470a-a062-fa1922dfa9a8",R="e95d6100-251d-470a-a062-fa1922dfa9a8",V="e95d9250-251d-470a-a062-fa1922dfa9a8";class U{constructor(){this.accelerometer={x:0,y:0,z:0},this.magnetometer_raw={x:0,y:0,z:0},this.magnetometer_bearing=0,this.temperature=0,this.buttonA=0,this.buttonACallBack=function(){},this.buttonB=0,this.buttonBCallBack=function(){},this.connected=!1,this.onConnectCallback=function(){},this.onDisconnectCallback=function(){},this.onBLENotifyCallback=function(){},this.characteristic={IO_PIN_DATA:{},IO_AD_CONFIG:{},IO_PIN_CONFIG:{},IO_PIN_PWM:{},LED_STATE:{},LED_TEXT:{},LED_SCROLL:{}}}getTemperature(){return this.temperature}getAccelerometer(){return this.accelerometer}getBearing(){return this.magnetometer_bearing}getButtonA(){return this.buttonA}setButtonACallback(t){this.buttonACallBack=t}getButtonB(){return this.buttonB}setButtonBCallback(t){this.buttonBCallBack=t}onConnect(t){this.onConnectCallback=t}onDisconnect(t){this.onDisconnectCallback=t}onBleNotify(t){this.onBLENotifyCallback=t}writePin(t){}readPin(t){}writeMatrixIcon(t){for(var e=new Int8Array(5),a=[["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"]],s=0;s<5;s++)for(var c=0;c<5;c++)a[s][7-c]=t[s][4-c];for(s=0;s<5;s++){var n=a[s].join("");e[s]=parseInt(n,2)}this.connected&&this.characteristic.LED_STATE.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}writeMatrixTextSpeed(t){var e=new Uint8Array(t);this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}writeMatrixText(t){var e=new Uint8Array(function(t){for(var e=[],a=0;a<t.length;a++){var s=t.charCodeAt(a);s<128?e.push(s):s<2048?e.push(192|s>>6,128|63&s):s<55296||s>=57344?e.push(224|s>>12,128|s>>6&63,128|63&s):(a++,s=65536+((1023&s)<<10|1023&t.charCodeAt(a)),e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|63&s))}return e}(t));this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}onButtonA(){this.buttonACallBack()}onButtonB(){this.buttonBCallBack()}characteristic_updated(t){this.onBLENotifyCallback(),t.target.uuid==T&&(this.buttonA=t.target.value.getInt8(),this.buttonA&&this.onButtonA()),t.target.uuid==q&&(this.buttonB=t.target.value.getInt8(),this.buttonB&&this.onButtonB()),t.target.uuid==B&&(this.accelerometer.x=t.target.value.getInt16(0,!0),this.accelerometer.y=t.target.value.getInt16(2,!0),this.accelerometer.z=t.target.value.getInt16(4,!0)),t.target.uuid==_&&(this.magnetometer_raw.x=t.target.value.getInt16(0,!0),this.magnetometer_raw.y=t.target.value.getInt16(2,!0),this.magnetometer_raw.z=t.target.value.getInt16(4,!0)),t.target.uuid==A&&(this.magnetometer_bearing=t.target.value.getInt16(0,!0)),t.target.uuid==V&&(this.temperature=t.target.value.getInt8())}searchDevice(){var t={acceptAllDevices:!0};t.optionalServices=[C,E,w,D,L,R],console.log("Requesting Bluetooth Device..."),console.log("with "+JSON.stringify(t)),navigator.bluetooth.requestDevice(t).then(t=>(console.log("> Name:             "+t.name),console.log("> Id:               "+t.id),t.addEventListener("gattserverdisconnected",this.onDisconnectCallback),t.gatt.connect())).then(t=>(this.onConnectCallback(),console.log("Getting Services..."),t.getPrimaryServices())).then(t=>{console.log("Getting Characteristics...");let e=Promise.resolve();return t.forEach(t=>{e=e.then(e=>t.getCharacteristics().then(e=>{console.log("> Service: "+t.uuid),e.forEach(t=>{switch(console.log(">> Characteristic: "+t.uuid+" "+M(t)),t.uuid){case x:this.characteristic.IO_PIN_DATA=t;break;case y:this.characteristic.IO_AD_CONFIG=t;break;case N:this.characteristic.IO_PIN_CONFIG=t;break;case z:this.characteristic.IO_PIN_PWM=t;break;case O:this.characteristic.LED_STATE=t,this.connected=!0;break;case P:this.characteristic.LED_TEXT=t;break;case S:this.characteristic.LED_SCROLL=t}M(t).includes("NOTIFY")&&(t.startNotifications().catch(t=>console.log("startNotifications",t)),t.addEventListener("characteristicvaluechanged",this.characteristic_updated.bind(this)))})}))}),e}).catch(t=>{console.log("Argh! "+t)})}}function M(t){let e=[];for(const a in t.properties)!0===t.properties[a]&&e.push(a.toUpperCase());return"["+e.join(", ")+"]"}class F{constructor(t){this.context=t,this.pausedSize=1}draw_line(t,e,a){this.context.strokeStyle="greenyellow",this.context.lineWidth=a,this.context.lineCap="round",this.context.lineTo(t,e),this.context.stroke(),this.context.beginPath(),this.context.moveTo(t,e)}draw_dot(t,e){this.context.fillStyle="yellow",this.context.fillRect(t,e,this.pausedSize,this.pausedSize)}mapValues(t,e,a,s,c){return(t-e)/(a-e)*(c-s)+s}}const{document:G,window:j}=k;function W(t){let e,a,g,v,m=(t[1]?t[9][1]:t[9][0])+"";return{c(){e=s("div"),a=s("button"),g=c(m),this.h()},l(t){e=n(t,"DIV",{class:!0});var s=i(e);a=n(s,"BUTTON",{class:!0});var c=i(a);g=o(c,m),c.forEach(r),s.forEach(r),this.h()},h(){l(a,"class","btn svelte-kq6aqz"),l(e,"class","svelte-kq6aqz"),v=h(a,"click",t[10])},m(t,s){d(t,e,s),u(e,a),u(a,g)},p(t,e){2&e&&m!==(m=(t[1]?t[9][1]:t[9][0])+"")&&f(g,m)},d(t){t&&r(e),v()}}}function X(t){let e,a;return{c(){e=s("button"),a=c("dot"),this.h()},l(t){e=n(t,"BUTTON",{class:!0});var s=i(e);a=o(s,"dot"),s.forEach(r),this.h()},h(){l(e,"class","btn-menu svelte-kq6aqz")},m(t,s){d(t,e,s),u(e,a)},p:m,d(t){t&&r(e)}}}function Z(t){let e,a,h=" "===t[8]?"line":"dot";return{c(){e=s("button"),a=c(h),this.h()},l(t){e=n(t,"BUTTON",{class:!0});var s=i(e);a=o(s,h),s.forEach(r),this.h()},h(){l(e,"class","btn-menu svelte-kq6aqz")},m(t,s){d(t,e,s),u(e,a)},p(t,e){256&e&&h!==(h=" "===t[8]?"line":"dot")&&f(a,h)},d(t){t&&r(e)}}}function H(t){let e,a,p,k,I,C,B,E,_,A,w,T,q,D,x,y,N,z,L,O,P,S,R,V,U,M,F,H,J=t[0]&&W(t);function Y(t,e){return t[8]?Z:X}let K=Y(t),Q=K(t);return{c(){e=g(),a=s("div"),p=s("h1"),k=c("LZRBIT"),I=g(),J&&J.c(),C=g(),B=s("div"),E=s("div"),Q.c(),_=g(),A=s("p"),w=c("x: "),T=c(t[5]),q=g(),D=s("p"),x=c("y: "),y=c(t[6]),N=g(),z=s("p"),L=c("z: "),O=c(t[7]),P=g(),S=s("button"),R=c("save"),V=g(),U=s("div"),M=s("canvas"),this.h()},l(s){e=v(s),a=n(s,"DIV",{class:!0});var c=i(a);p=n(c,"H1",{class:!0});var l=i(p);k=o(l,"LZRBIT"),l.forEach(r),I=v(c),J&&J.l(c),C=v(c),B=n(c,"DIV",{class:!0});var h=i(B);E=n(h,"DIV",{class:!0});var d=i(E);Q.l(d),_=v(d),A=n(d,"P",{class:!0});var u=i(A);w=o(u,"x: "),T=o(u,t[5]),u.forEach(r),q=v(d),D=n(d,"P",{class:!0});var f=i(D);x=o(f,"y: "),y=o(f,t[6]),f.forEach(r),N=v(d),z=n(d,"P",{class:!0});var g=i(z);L=o(g,"z: "),O=o(g,t[7]),g.forEach(r),P=v(d),S=n(d,"BUTTON",{class:!0});var m=i(S);R=o(m,"save"),m.forEach(r),d.forEach(r),h.forEach(r),V=v(c),U=n(c,"DIV",{hidden:!0,class:!0});var b=i(U);M=n(b,"CANVAS",{width:!0,height:!0,class:!0}),i(M).forEach(r),b.forEach(r),c.forEach(r),this.h()},h(){G.title="LZRBTI-APP",l(p,"class","svelte-kq6aqz"),l(A,"class","svelte-kq6aqz"),l(D,"class","svelte-kq6aqz"),l(z,"class","svelte-kq6aqz"),l(S,"class","btn-menu svelte-kq6aqz"),l(E,"class","grid-container svelte-kq6aqz"),l(B,"class","flex-container svelte-kq6aqz"),l(M,"width",t[3]),l(M,"height",t[4]),l(M,"class","svelte-kq6aqz"),U.hidden=F=!t[1],l(U,"class","svelte-kq6aqz"),l(a,"class","flex-container svelte-kq6aqz"),H=[h(j,"keydown",t[12]),h(S,"click",t[11])]},m(s,c){d(s,e,c),d(s,a,c),u(a,p),u(p,k),u(a,I),J&&J.m(a,null),u(a,C),u(a,B),u(B,E),Q.m(E,null),u(E,_),u(E,A),u(A,w),u(A,T),u(E,q),u(E,D),u(D,x),u(D,y),u(E,N),u(E,z),u(z,L),u(z,O),u(E,P),u(E,S),u(S,R),u(a,V),u(a,U),u(U,M),t[16](M)},p(t,[e]){t[0]?J?J.p(t,e):((J=W(t)).c(),J.m(a,C)):J&&(J.d(1),J=null),K===(K=Y(t))&&Q?Q.p(t,e):(Q.d(1),(Q=K(t))&&(Q.c(),Q.m(E,_))),32&e&&f(T,t[5]),64&e&&f(y,t[6]),128&e&&f(O,t[7]),8&e&&l(M,"width",t[3]),16&e&&l(M,"height",t[4]),2&e&&F!==(F=!t[1])&&(U.hidden=F)},i:m,o:m,d(s){s&&r(e),s&&r(a),J&&J.d(),Q.d(),t[16](null),b(H)}}}function J(t,e,a){let s,c,n,i,o,r,l=!0,h=!1,d=new U,u=0,f=0,g=0;return p(()=>{a(3,n=window.innerWidth),a(4,i=window.innerHeight),c=s.getContext("2d");let t=new F(c);!function e(){if(c.globalCompositeOperation="lighter",h)if("l"===r){c.fillStyle="black",c.fillRect(0,0,n,i);let e=t.mapValues(u,-1024,1024,0,n),a=t.mapValues(f,-1024,1024,0,i);t.draw_line(e,a,0,1)}else if("p"===r){c.fillStyle="black",c.fillRect(0,0,n,i);let e=t.mapValues(u,-1024,1024,0,n),a=t.mapValues(f,-1024,1024,0,i);t.draw_dot(e,a),c.beginPath()}else c.fillStyle="black",c.fillRect(0,0,n,i);o=requestAnimationFrame(e)}()}),[l,h,s,n,i,u,f,g,r,["PAIR MICROBIT","PAIRED"],function(){d.searchDevice(),d.onConnect(()=>{console.log("connected"),a(1,h=!0),console.log("pared: true")}),d.onBleNotify(function(){a(5,u=d.getAccelerometer().x),a(6,f=d.getAccelerometer().y),a(7,g=d.getAccelerometer().z)}),a(0,l=!1)},function(){console.log("saveDrawing");const t=document.createElement("a");document.body.appendChild(t),t.href=s.toDataURL("image/png",1),t.download="canvas-image.png",t.click(),document.body.removeChild(t)},function(t){a(8,r=t.key)},c,o,d,function(t){I[t?"unshift":"push"](()=>{a(2,s=t)})}]}export default class extends t{constructor(t){super(),e(this,t,J,H,a,{})}}
