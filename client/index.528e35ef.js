import{S as t,i as e,s as a,e as s,t as i,c,b as n,d as r,f as o,h as l,L as h,k as d,l as u,y as f,a as g,g as v,n as w,M as b,I as m,N as p,O as I}from"./index.f67fa270.js";import"./index.0833934d.js";var E="e95d0753-251d-470a-a062-fa1922dfa9a8",C="e95dca4b-251d-470a-a062-fa1922dfa9a8",_="e95df2d8-251d-470a-a062-fa1922dfa9a8",x="e95dfb11-251d-470a-a062-fa1922dfa9a8",B="e95d9715-251d-470a-a062-fa1922dfa9a8",A="e95d9882-251d-470a-a062-fa1922dfa9a8",k="e95dda90-251d-470a-a062-fa1922dfa9a8",T="e95dda91-251d-470a-a062-fa1922dfa9a8",D="e95d127b-251d-470a-a062-fa1922dfa9a8",y="e95d8d00-251d-470a-a062-fa1922dfa9a8",S="e95d5899-251d-470a-a062-fa1922dfa9a8",N="e95db9fe-251d-470a-a062-fa1922dfa9a8",L="e95dd822-251d-470a-a062-fa1922dfa9a8",O="e95dd91d-251d-470a-a062-fa1922dfa9a8",P="e95d7b77-251d-470a-a062-fa1922dfa9a8",V="e95d93ee-251d-470a-a062-fa1922dfa9a8",R="e95d0d2d-251d-470a-a062-fa1922dfa9a8",z="e95d6100-251d-470a-a062-fa1922dfa9a8",U="e95d9250-251d-470a-a062-fa1922dfa9a8";class M{constructor(){this.accelerometer={x:0,y:0,z:0},this.magnetometer_raw={x:0,y:0,z:0},this.magnetometer_bearing=0,this.temperature=0,this.buttonA=0,this.buttonACallBack=function(){},this.buttonB=0,this.buttonBCallBack=function(){},this.connected=!1,this.onConnectCallback=function(){},this.onDisconnectCallback=function(){},this.onBLENotifyCallback=function(){},this.characteristic={IO_PIN_DATA:{},IO_AD_CONFIG:{},IO_PIN_CONFIG:{},IO_PIN_PWM:{},LED_STATE:{},LED_TEXT:{},LED_SCROLL:{}}}getTemperature(){return this.temperature}getAccelerometer(){return this.accelerometer}getBearing(){return this.magnetometer_bearing}getButtonA(){return this.buttonA}setButtonACallback(t){this.buttonACallBack=t}getButtonB(){return this.buttonB}setButtonBCallback(t){this.buttonBCallBack=t}onConnect(t){this.onConnectCallback=t}onDisconnect(t){this.onDisconnectCallback=t}onBleNotify(t){this.onBLENotifyCallback=t}writePin(t){}readPin(t){}writeMatrixIcon(t){for(var e=new Int8Array(5),a=[["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"]],s=0;s<5;s++)for(var i=0;i<5;i++)a[s][7-i]=t[s][4-i];for(s=0;s<5;s++){var c=a[s].join("");e[s]=parseInt(c,2)}this.connected&&this.characteristic.LED_STATE.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}writeMatrixTextSpeed(t){var e=new Uint8Array(t);this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}writeMatrixText(t){var e=new Uint8Array(function(t){for(var e=[],a=0;a<t.length;a++){var s=t.charCodeAt(a);s<128?e.push(s):s<2048?e.push(192|s>>6,128|63&s):s<55296||s>=57344?e.push(224|s>>12,128|s>>6&63,128|63&s):(a++,s=65536+((1023&s)<<10|1023&t.charCodeAt(a)),e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|63&s))}return e}(t));this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}onButtonA(){this.buttonACallBack()}onButtonB(){this.buttonBCallBack()}characteristic_updated(t){this.onBLENotifyCallback(),t.target.uuid==k&&(this.buttonA=t.target.value.getInt8(),this.buttonA&&this.onButtonA()),t.target.uuid==T&&(this.buttonB=t.target.value.getInt8(),this.buttonB&&this.onButtonB()),t.target.uuid==C&&(this.accelerometer.x=t.target.value.getInt16(0,!0),this.accelerometer.y=t.target.value.getInt16(2,!0),this.accelerometer.z=t.target.value.getInt16(4,!0)),t.target.uuid==x&&(this.magnetometer_raw.x=t.target.value.getInt16(0,!0),this.magnetometer_raw.y=t.target.value.getInt16(2,!0),this.magnetometer_raw.z=t.target.value.getInt16(4,!0)),t.target.uuid==B&&(this.magnetometer_bearing=t.target.value.getInt16(0,!0)),t.target.uuid==U&&(this.temperature=t.target.value.getInt8())}searchDevice(){var t={acceptAllDevices:!0};t.optionalServices=[E,_,A,D,O,z],console.log("Requesting Bluetooth Device..."),console.log("with "+JSON.stringify(t)),navigator.bluetooth.requestDevice(t).then(t=>(console.log("> Name:             "+t.name),console.log("> Id:               "+t.id),t.addEventListener("gattserverdisconnected",this.onDisconnectCallback),t.gatt.connect())).then(t=>(this.onConnectCallback(),console.log("Getting Services..."),t.getPrimaryServices())).then(t=>{console.log("Getting Characteristics...");let e=Promise.resolve();return t.forEach(t=>{e=e.then(e=>t.getCharacteristics().then(e=>{console.log("> Service: "+t.uuid),e.forEach(t=>{switch(console.log(">> Characteristic: "+t.uuid+" "+F(t)),t.uuid){case y:this.characteristic.IO_PIN_DATA=t;break;case S:this.characteristic.IO_AD_CONFIG=t;break;case N:this.characteristic.IO_PIN_CONFIG=t;break;case L:this.characteristic.IO_PIN_PWM=t;break;case P:this.characteristic.LED_STATE=t,this.connected=!0;break;case V:this.characteristic.LED_TEXT=t;break;case R:this.characteristic.LED_SCROLL=t}F(t).includes("NOTIFY")&&(t.startNotifications().catch(t=>console.log("startNotifications",t)),t.addEventListener("characteristicvaluechanged",this.characteristic_updated.bind(this)))})}))}),e}).catch(t=>{console.log("Argh! "+t)})}}function F(t){let e=[];for(const a in t.properties)!0===t.properties[a]&&e.push(a.toUpperCase());return"["+e.join(", ")+"]"}class G{constructor(t){this.context=t,this.pausedSize=1,this.axisSize=3}draw_line(t,e,a){this.context.strokeStyle="greenyellow",this.context.lineWidth=a,this.context.lineCap="round",this.context.lineTo(t,e),this.context.stroke(),this.context.beginPath(),this.context.moveTo(t,e)}draw_point(t,e){this.context.fillStyle="yellow",this.context.fillRect(t,e,this.pausedSize,this.pausedSize)}draw_axis(t,e,a,s){this.context.fillStyle="black",this.context.fillRect(0,0,a,s),this.context.fillStyle="yellow",this.context.fillRect(t,e,this.axisSize,this.axisSize)}mapValues(t,e,a,s,i){return(t-e)/(a-e)*(i-s)+s}}const{document:W,window:j}=p;function q(t){let e,a,g,v,w=(t[1]?t[9][1]:t[9][0])+"";return{c(){e=s("div"),a=s("button"),g=i(w),this.h()},l(t){e=c(t,"DIV",{class:!0});var s=n(e);a=c(s,"BUTTON",{class:!0});var i=n(a);g=r(i,w),i.forEach(o),s.forEach(o),this.h()},h(){l(a,"class","btn svelte-15wwbf5"),l(e,"class","svelte-15wwbf5"),v=h(a,"click",t[10])},m(t,s){d(t,e,s),u(e,a),u(a,g)},p(t,e){2&e&&w!==(w=(t[1]?t[9][1]:t[9][0])+"")&&f(g,w)},d(t){t&&o(e),v()}}}function X(t){let e,a;return{c(){e=s("button"),a=i("draw"),this.h()},l(t){e=c(t,"BUTTON",{class:!0});var s=n(e);a=r(s,"draw"),s.forEach(o),this.h()},h(){l(e,"class","btn-menu svelte-15wwbf5")},m(t,s){d(t,e,s),u(e,a)},p:w,d(t){t&&o(e)}}}function Z(t){let e,a,h=""===t[8]?"line":"dot";return{c(){e=s("button"),a=i(h),this.h()},l(t){e=c(t,"BUTTON",{class:!0});var s=n(e);a=r(s,h),s.forEach(o),this.h()},h(){l(e,"class","btn-menu svelte-15wwbf5")},m(t,s){d(t,e,s),u(e,a)},p(t,e){256&e&&h!==(h=""===t[8]?"line":"dot")&&f(a,h)},d(t){t&&o(e)}}}function H(t){let e,a,m,p,I,E,C,_,x,B,A,k,T,D,y,S,N,L,O,P,V,R,z,U,M,F,G,H,Q,J,Y,K,$=t[0]&&q(t);function tt(t,e){return t[8]?Z:X}let et=tt(t),at=et(t);return{c(){e=g(),a=s("div"),m=s("h1"),p=i("LZRBIT"),I=g(),$&&$.c(),E=g(),C=s("div"),_=s("div"),at.c(),x=g(),B=s("p"),A=i("x: "),k=i(t[5]),T=g(),D=s("p"),y=i("y: "),S=i(t[6]),N=g(),L=s("p"),O=i("z: "),P=i(t[7]),V=g(),R=s("button"),z=i("save"),U=g(),M=s("div"),F=s("canvas"),G=g(),H=s("div"),Q=s("div"),J=i("[!] press Q to draw lines | press W to draw points | press SPACE to reset [!]"),this.h()},l(s){e=v(s),a=c(s,"DIV",{class:!0});var i=n(a);m=c(i,"H1",{class:!0});var l=n(m);p=r(l,"LZRBIT"),l.forEach(o),I=v(i),$&&$.l(i),E=v(i),C=c(i,"DIV",{class:!0});var h=n(C);_=c(h,"DIV",{class:!0});var d=n(_);at.l(d),x=v(d),B=c(d,"P",{class:!0});var u=n(B);A=r(u,"x: "),k=r(u,t[5]),u.forEach(o),T=v(d),D=c(d,"P",{class:!0});var f=n(D);y=r(f,"y: "),S=r(f,t[6]),f.forEach(o),N=v(d),L=c(d,"P",{class:!0});var g=n(L);O=r(g,"z: "),P=r(g,t[7]),g.forEach(o),V=v(d),R=c(d,"BUTTON",{class:!0});var w=n(R);z=r(w,"save"),w.forEach(o),d.forEach(o),h.forEach(o),U=v(i),M=c(i,"DIV",{hidden:!0,class:!0});var b=n(M);F=c(b,"CANVAS",{width:!0,height:!0,class:!0}),n(F).forEach(o),G=v(b),H=c(b,"DIV",{class:!0});var W=n(H);Q=c(W,"DIV",{class:!0});var j=n(Q);J=r(j,"[!] press Q to draw lines | press W to draw points | press SPACE to reset [!]"),j.forEach(o),W.forEach(o),b.forEach(o),i.forEach(o),this.h()},h(){W.title="LZRBTI-APP",l(m,"class","svelte-15wwbf5"),l(B,"class","svelte-15wwbf5"),l(D,"class","svelte-15wwbf5"),l(L,"class","svelte-15wwbf5"),l(R,"class","btn-menu svelte-15wwbf5"),l(_,"class","grid-container svelte-15wwbf5"),l(C,"class","flex-container svelte-15wwbf5"),l(F,"width",t[3]),l(F,"height",t[4]),l(F,"class","svelte-15wwbf5"),l(Q,"class","svelte-15wwbf5"),l(H,"class","flex-container svelte-15wwbf5"),M.hidden=Y=!t[1],l(M,"class","svelte-15wwbf5"),l(a,"class","flex-container svelte-15wwbf5"),K=[h(j,"keydown",t[12]),h(R,"click",t[11])]},m(s,i){d(s,e,i),d(s,a,i),u(a,m),u(m,p),u(a,I),$&&$.m(a,null),u(a,E),u(a,C),u(C,_),at.m(_,null),u(_,x),u(_,B),u(B,A),u(B,k),u(_,T),u(_,D),u(D,y),u(D,S),u(_,N),u(_,L),u(L,O),u(L,P),u(_,V),u(_,R),u(R,z),u(a,U),u(a,M),u(M,F),t[16](F),u(M,G),u(M,H),u(H,Q),u(Q,J)},p(t,[e]){t[0]?$?$.p(t,e):(($=q(t)).c(),$.m(a,E)):$&&($.d(1),$=null),et===(et=tt(t))&&at?at.p(t,e):(at.d(1),(at=et(t))&&(at.c(),at.m(_,x))),32&e&&f(k,t[5]),64&e&&f(S,t[6]),128&e&&f(P,t[7]),8&e&&l(F,"width",t[3]),16&e&&l(F,"height",t[4]),2&e&&Y!==(Y=!t[1])&&(M.hidden=Y)},i:w,o:w,d(s){s&&o(e),s&&o(a),$&&$.d(),at.d(),t[16](null),b(K)}}}function Q(t,e,a){let s,i,c,n,r,o,l=!0,h=!1,d=new M,u=0,f=0,g=0;return m(()=>{a(3,c=window.innerWidth),a(4,n=window.innerHeight),i=s.getContext("2d");let t=new G(i);i.imageSmoothingEnabled=!0,function e(){if(i.globalCompositeOperation="lighter",h)if("q"===o){i.fillStyle="black",i.fillRect(0,0,c,n);let e=t.mapValues(u,-1024,1024,0,c),a=t.mapValues(f,-1024,1024,0,n);t.draw_line(e,a,0,1)}else if("w"===o){i.fillStyle="black",i.fillRect(0,0,c,n);let e=t.mapValues(u,-1024,1024,0,c),a=t.mapValues(f,-1024,1024,0,n);t.draw_point(e,a),i.beginPath()}else if(" "===o){i.clearRect(0,0,c,n);let e=t.mapValues(u,-1024,1024,0,c),a=t.mapValues(f,-1024,1024,0,n);t.draw_axis(e,a,c,n)}else{i.clearRect(0,0,c,n);let e=t.mapValues(u,-1024,1024,0,c),a=t.mapValues(f,-1024,1024,0,n);t.draw_axis(e,a,c,n)}r=requestAnimationFrame(e)}()}),[l,h,s,c,n,u,f,g,o,["PAIR MICROBIT","PAIRED"],function(){d.searchDevice(),d.onConnect(()=>{console.log("connected"),a(1,h=!0),console.log("pared: true")}),d.onBleNotify(function(){a(5,u=d.getAccelerometer().x),a(6,f=d.getAccelerometer().y),a(7,g=d.getAccelerometer().z)}),a(0,l=!1)},function(){console.log("saveDrawing");const t=document.createElement("a");document.body.appendChild(t),t.href=s.toDataURL("image/png",1),t.download="canvas-image.png",t.click(),document.body.removeChild(t)},function(t){a(8,o=t.key)},i,r,d,function(t){I[t?"unshift":"push"](()=>{a(2,s=t)})}]}export default class extends t{constructor(t){super(),e(this,t,Q,H,a,{})}}
