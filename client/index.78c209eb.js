import{S as t,i as e,s as a,e as s,t as i,c,b as n,d as r,f as o,h as l,L as h,k as d,l as u,y as f,a as g,g as v,n as m,M as b,I as p,N as k,O as I}from"./index.f67fa270.js";import"./index.0833934d.js";var w="e95d0753-251d-470a-a062-fa1922dfa9a8",C="e95dca4b-251d-470a-a062-fa1922dfa9a8",B="e95df2d8-251d-470a-a062-fa1922dfa9a8",_="e95dfb11-251d-470a-a062-fa1922dfa9a8",E="e95d9715-251d-470a-a062-fa1922dfa9a8",x="e95d9882-251d-470a-a062-fa1922dfa9a8",A="e95dda90-251d-470a-a062-fa1922dfa9a8",T="e95dda91-251d-470a-a062-fa1922dfa9a8",y="e95d127b-251d-470a-a062-fa1922dfa9a8",D="e95d8d00-251d-470a-a062-fa1922dfa9a8",N="e95d5899-251d-470a-a062-fa1922dfa9a8",S="e95db9fe-251d-470a-a062-fa1922dfa9a8",L="e95dd822-251d-470a-a062-fa1922dfa9a8",O="e95dd91d-251d-470a-a062-fa1922dfa9a8",P="e95d7b77-251d-470a-a062-fa1922dfa9a8",R="e95d93ee-251d-470a-a062-fa1922dfa9a8",V="e95d0d2d-251d-470a-a062-fa1922dfa9a8",z="e95d6100-251d-470a-a062-fa1922dfa9a8",U="e95d9250-251d-470a-a062-fa1922dfa9a8";class M{constructor(){this.accelerometer={x:0,y:0,z:0},this.magnetometer_raw={x:0,y:0,z:0},this.magnetometer_bearing=0,this.temperature=0,this.buttonA=0,this.buttonACallBack=function(){},this.buttonB=0,this.buttonBCallBack=function(){},this.connected=!1,this.onConnectCallback=function(){},this.onDisconnectCallback=function(){},this.onBLENotifyCallback=function(){},this.characteristic={IO_PIN_DATA:{},IO_AD_CONFIG:{},IO_PIN_CONFIG:{},IO_PIN_PWM:{},LED_STATE:{},LED_TEXT:{},LED_SCROLL:{}}}getTemperature(){return this.temperature}getAccelerometer(){return this.accelerometer}getBearing(){return this.magnetometer_bearing}getButtonA(){return this.buttonA}setButtonACallback(t){this.buttonACallBack=t}getButtonB(){return this.buttonB}setButtonBCallback(t){this.buttonBCallBack=t}onConnect(t){this.onConnectCallback=t}onDisconnect(t){this.onDisconnectCallback=t}onBleNotify(t){this.onBLENotifyCallback=t}writePin(t){}readPin(t){}writeMatrixIcon(t){for(var e=new Int8Array(5),a=[["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"]],s=0;s<5;s++)for(var i=0;i<5;i++)a[s][7-i]=t[s][4-i];for(s=0;s<5;s++){var c=a[s].join("");e[s]=parseInt(c,2)}this.connected&&this.characteristic.LED_STATE.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}writeMatrixTextSpeed(t){var e=new Uint8Array(t);this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}writeMatrixText(t){var e=new Uint8Array(function(t){for(var e=[],a=0;a<t.length;a++){var s=t.charCodeAt(a);s<128?e.push(s):s<2048?e.push(192|s>>6,128|63&s):s<55296||s>=57344?e.push(224|s>>12,128|s>>6&63,128|63&s):(a++,s=65536+((1023&s)<<10|1023&t.charCodeAt(a)),e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|63&s))}return e}(t));this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}onButtonA(){this.buttonACallBack()}onButtonB(){this.buttonBCallBack()}characteristic_updated(t){this.onBLENotifyCallback(),t.target.uuid==A&&(this.buttonA=t.target.value.getInt8(),this.buttonA&&this.onButtonA()),t.target.uuid==T&&(this.buttonB=t.target.value.getInt8(),this.buttonB&&this.onButtonB()),t.target.uuid==C&&(this.accelerometer.x=t.target.value.getInt16(0,!0),this.accelerometer.y=t.target.value.getInt16(2,!0),this.accelerometer.z=t.target.value.getInt16(4,!0)),t.target.uuid==_&&(this.magnetometer_raw.x=t.target.value.getInt16(0,!0),this.magnetometer_raw.y=t.target.value.getInt16(2,!0),this.magnetometer_raw.z=t.target.value.getInt16(4,!0)),t.target.uuid==E&&(this.magnetometer_bearing=t.target.value.getInt16(0,!0)),t.target.uuid==U&&(this.temperature=t.target.value.getInt8())}searchDevice(){var t={acceptAllDevices:!0};t.optionalServices=[w,B,x,y,O,z],console.log("Requesting Bluetooth Device..."),console.log("with "+JSON.stringify(t)),navigator.bluetooth.requestDevice(t).then(t=>(console.log("> Name:             "+t.name),console.log("> Id:               "+t.id),t.addEventListener("gattserverdisconnected",this.onDisconnectCallback),t.gatt.connect())).then(t=>(this.onConnectCallback(),console.log("Getting Services..."),t.getPrimaryServices())).then(t=>{console.log("Getting Characteristics...");let e=Promise.resolve();return t.forEach(t=>{e=e.then(e=>t.getCharacteristics().then(e=>{console.log("> Service: "+t.uuid),e.forEach(t=>{switch(console.log(">> Characteristic: "+t.uuid+" "+F(t)),t.uuid){case D:this.characteristic.IO_PIN_DATA=t;break;case N:this.characteristic.IO_AD_CONFIG=t;break;case S:this.characteristic.IO_PIN_CONFIG=t;break;case L:this.characteristic.IO_PIN_PWM=t;break;case P:this.characteristic.LED_STATE=t,this.connected=!0;break;case R:this.characteristic.LED_TEXT=t;break;case V:this.characteristic.LED_SCROLL=t}F(t).includes("NOTIFY")&&(t.startNotifications().catch(t=>console.log("startNotifications",t)),t.addEventListener("characteristicvaluechanged",this.characteristic_updated.bind(this)))})}))}),e}).catch(t=>{console.log("Argh! "+t)})}}function F(t){let e=[];for(const a in t.properties)!0===t.properties[a]&&e.push(a.toUpperCase());return"["+e.join(", ")+"]"}class G{constructor(t){this.context=t,this.pausedSize=1,this.axisSize=3}draw_line(t,e,a){this.context.strokeStyle="greenyellow",this.context.lineWidth=a,this.context.lineCap="round",this.context.lineTo(t,e),this.context.stroke(),this.context.beginPath(),this.context.moveTo(t,e)}draw_point(t,e){this.context.fillStyle="yellow",this.context.fillRect(t,e,this.pausedSize,this.pausedSize)}draw_axis(t,e,a,s){this.context.fillStyle="black",this.context.fillRect(0,0,a,s),this.context.fillStyle="yellow",this.context.fillRect(t,e,this.axisSize,this.axisSize)}mapValues(t,e,a,s,i){return(t-e)/(a-e)*(i-s)+s}}const{document:j,window:q}=k;function W(t){let e,a,g,v,m=(t[1]?t[9][1]:t[9][0])+"";return{c(){e=s("div"),a=s("button"),g=i(m),this.h()},l(t){e=c(t,"DIV",{class:!0});var s=n(e);a=c(s,"BUTTON",{class:!0});var i=n(a);g=r(i,m),i.forEach(o),s.forEach(o),this.h()},h(){l(a,"class","btn svelte-krsuh1"),l(e,"class","svelte-krsuh1"),v=h(a,"click",t[10])},m(t,s){d(t,e,s),u(e,a),u(a,g)},p(t,e){2&e&&m!==(m=(t[1]?t[9][1]:t[9][0])+"")&&f(g,m)},d(t){t&&o(e),v()}}}function X(t){let e,a;return{c(){e=s("button"),a=i("draw"),this.h()},l(t){e=c(t,"BUTTON",{class:!0});var s=n(e);a=r(s,"draw"),s.forEach(o),this.h()},h(){l(e,"class","btn-menu svelte-krsuh1")},m(t,s){d(t,e,s),u(e,a)},p:m,d(t){t&&o(e)}}}function Z(t){let e,a,h="l"===t[8]?"line":"dot";return{c(){e=s("button"),a=i(h),this.h()},l(t){e=c(t,"BUTTON",{class:!0});var s=n(e);a=r(s,h),s.forEach(o),this.h()},h(){l(e,"class","btn-menu svelte-krsuh1")},m(t,s){d(t,e,s),u(e,a)},p(t,e){256&e&&h!==(h="l"===t[8]?"line":"dot")&&f(a,h)},d(t){t&&o(e)}}}function H(t){let e,a,p,k,I,w,C,B,_,E,x,A,T,y,D,N,S,L,O,P,R,V,z,U,M,F,G,H,J=t[0]&&W(t);function Y(t,e){return t[8]?Z:X}let K=Y(t),Q=K(t);return{c(){e=g(),a=s("div"),p=s("h1"),k=i("LZRBIT"),I=g(),J&&J.c(),w=g(),C=s("div"),B=s("div"),Q.c(),_=g(),E=s("p"),x=i("x: "),A=i(t[5]),T=g(),y=s("p"),D=i("y: "),N=i(t[6]),S=g(),L=s("p"),O=i("z: "),P=i(t[7]),R=g(),V=s("button"),z=i("save"),U=g(),M=s("div"),F=s("canvas"),this.h()},l(s){e=v(s),a=c(s,"DIV",{class:!0});var i=n(a);p=c(i,"H1",{class:!0});var l=n(p);k=r(l,"LZRBIT"),l.forEach(o),I=v(i),J&&J.l(i),w=v(i),C=c(i,"DIV",{class:!0});var h=n(C);B=c(h,"DIV",{class:!0});var d=n(B);Q.l(d),_=v(d),E=c(d,"P",{class:!0});var u=n(E);x=r(u,"x: "),A=r(u,t[5]),u.forEach(o),T=v(d),y=c(d,"P",{class:!0});var f=n(y);D=r(f,"y: "),N=r(f,t[6]),f.forEach(o),S=v(d),L=c(d,"P",{class:!0});var g=n(L);O=r(g,"z: "),P=r(g,t[7]),g.forEach(o),R=v(d),V=c(d,"BUTTON",{class:!0});var m=n(V);z=r(m,"save"),m.forEach(o),d.forEach(o),h.forEach(o),U=v(i),M=c(i,"DIV",{hidden:!0,class:!0});var b=n(M);F=c(b,"CANVAS",{width:!0,height:!0,class:!0}),n(F).forEach(o),b.forEach(o),i.forEach(o),this.h()},h(){j.title="LZRBTI-APP",l(p,"class","svelte-krsuh1"),l(E,"class","svelte-krsuh1"),l(y,"class","svelte-krsuh1"),l(L,"class","svelte-krsuh1"),l(V,"class","btn-menu svelte-krsuh1"),l(B,"class","grid-container svelte-krsuh1"),l(C,"class","flex-container svelte-krsuh1"),l(F,"width",t[3]),l(F,"height",t[4]),l(F,"class","svelte-krsuh1"),M.hidden=G=!t[1],l(M,"class","svelte-krsuh1"),l(a,"class","flex-container svelte-krsuh1"),H=[h(q,"keydown",t[12]),h(V,"click",t[11])]},m(s,i){d(s,e,i),d(s,a,i),u(a,p),u(p,k),u(a,I),J&&J.m(a,null),u(a,w),u(a,C),u(C,B),Q.m(B,null),u(B,_),u(B,E),u(E,x),u(E,A),u(B,T),u(B,y),u(y,D),u(y,N),u(B,S),u(B,L),u(L,O),u(L,P),u(B,R),u(B,V),u(V,z),u(a,U),u(a,M),u(M,F),t[16](F)},p(t,[e]){t[0]?J?J.p(t,e):((J=W(t)).c(),J.m(a,w)):J&&(J.d(1),J=null),K===(K=Y(t))&&Q?Q.p(t,e):(Q.d(1),(Q=K(t))&&(Q.c(),Q.m(B,_))),32&e&&f(A,t[5]),64&e&&f(N,t[6]),128&e&&f(P,t[7]),8&e&&l(F,"width",t[3]),16&e&&l(F,"height",t[4]),2&e&&G!==(G=!t[1])&&(M.hidden=G)},i:m,o:m,d(s){s&&o(e),s&&o(a),J&&J.d(),Q.d(),t[16](null),b(H)}}}function J(t,e,a){let s,i,c,n,r,o,l=!0,h=!1,d=new M,u=0,f=0,g=0;return p(()=>{a(3,c=window.innerWidth),a(4,n=window.innerHeight),i=s.getContext("2d");let t=new G(i);!function e(){if(i.globalCompositeOperation="lighter",h)if("q"===o){i.fillStyle="black",i.fillRect(0,0,c,n);let e=t.mapValues(u,-1024,1024,0,c),a=t.mapValues(f,-1024,1024,0,n);t.draw_line(e,a,0,1)}else if("w"===o){i.fillStyle="black",i.fillRect(0,0,c,n);let e=t.mapValues(u,-1024,1024,0,c),a=t.mapValues(f,-1024,1024,0,n);t.draw_point(e,a),i.beginPath()}else if(" "===o){i.clearRect(0,0,c,n);let e=t.mapValues(u,-1024,1024,0,c),a=t.mapValues(f,-1024,1024,0,n);t.draw_axis(e,a,c,n)}else i.fillStyle="black",i.fillRect(0,0,c,n);r=requestAnimationFrame(e)}()}),[l,h,s,c,n,u,f,g,o,["PAIR MICROBIT","PAIRED"],function(){d.searchDevice(),d.onConnect(()=>{console.log("connected"),a(1,h=!0),console.log("pared: true")}),d.onBleNotify(function(){a(5,u=d.getAccelerometer().x),a(6,f=d.getAccelerometer().y),a(7,g=d.getAccelerometer().z)}),a(0,l=!1)},function(){console.log("saveDrawing");const t=document.createElement("a");document.body.appendChild(t),t.href=s.toDataURL("image/png",1),t.download="canvas-image.png",t.click(),document.body.removeChild(t)},function(t){a(8,o=t.key)},i,r,d,function(t){I[t?"unshift":"push"](()=>{a(2,s=t)})}]}export default class extends t{constructor(t){super(),e(this,t,J,H,a,{})}}
