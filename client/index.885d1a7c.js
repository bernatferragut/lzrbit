import{S as t,i as e,s as a,e as i,t as n,c as s,b as c,d as o,f as r,h as l,L as d,k as h,l as u,y as f,a as g,g as v,n as m,M as b,I as w,N as p,O as E}from"./index.f67fa270.js";import"./index.0833934d.js";class I{constructor(){this.accelerometer={x:0,y:0,z:0},this.magnetometer_raw={x:0,y:0,z:0},this.magnetometer_bearing=0,this.temperature=0,this.buttonA=0,this.buttonACallBack=function(){},this.buttonB=0,this.buttonBCallBack=function(){},this.connected=!1,this.onConnectCallback=function(){},this.onDisconnectCallback=function(){},this.onBLENotifyCallback=function(){},this.characteristic={IO_PIN_DATA:{},IO_AD_CONFIG:{},IO_PIN_CONFIG:{},IO_PIN_PWM:{},LED_STATE:{},LED_TEXT:{},LED_SCROLL:{}}}getTemperature(){return this.temperature}getAccelerometer(){return this.accelerometer}getBearing(){return this.magnetometer_bearing}getButtonA(){return this.buttonA}setButtonACallback(t){this.buttonACallBack=t}getButtonB(){return this.buttonB}setButtonBCallback(t){this.buttonBCallBack=t}onConnect(t){this.onConnectCallback=t}onDisconnect(t){this.onDisconnectCallback=t}onBleNotify(t){this.onBLENotifyCallback=t}writePin(t){}readPin(t){}writeMatrixIcon(t){for(var e=new Int8Array(5),a=[["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"]],i=0;i<5;i++)for(var n=0;n<5;n++)a[i][7-n]=t[i][4-n];for(i=0;i<5;i++){var s=a[i].join("");e[i]=parseInt(s,2)}this.connected&&this.characteristic.LED_STATE.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}writeMatrixTextSpeed(t){var e=new Uint8Array(t);this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}writeMatrixText(t){var e=new Uint8Array(function(t){for(var e=[],a=0;a<t.length;a++){var i=t.charCodeAt(a);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(a++,i=65536+((1023&i)<<10|1023&t.charCodeAt(a)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e}(t));this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(t=>{}).catch(t=>{console.log(t)})}onButtonA(){this.buttonACallBack()}onButtonB(){this.buttonBCallBack()}characteristic_updated(t){this.onBLENotifyCallback(),"e95dda90-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.buttonA=t.target.value.getInt8(),this.buttonA&&this.onButtonA()),"e95dda91-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.buttonB=t.target.value.getInt8(),this.buttonB&&this.onButtonB()),"e95dca4b-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.accelerometer.x=t.target.value.getInt16(0,!0),this.accelerometer.y=t.target.value.getInt16(2,!0),this.accelerometer.z=t.target.value.getInt16(4,!0)),"e95dfb11-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.magnetometer_raw.x=t.target.value.getInt16(0,!0),this.magnetometer_raw.y=t.target.value.getInt16(2,!0),this.magnetometer_raw.z=t.target.value.getInt16(4,!0)),"e95d9715-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.magnetometer_bearing=t.target.value.getInt16(0,!0)),"e95d9250-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.temperature=t.target.value.getInt8())}searchDevice(){var t={acceptAllDevices:!0,optionalServices:["e95d0753-251d-470a-a062-fa1922dfa9a8","e95df2d8-251d-470a-a062-fa1922dfa9a8","e95d9882-251d-470a-a062-fa1922dfa9a8","e95d127b-251d-470a-a062-fa1922dfa9a8","e95dd91d-251d-470a-a062-fa1922dfa9a8","e95d6100-251d-470a-a062-fa1922dfa9a8"]};console.log("Requesting Bluetooth Device..."),console.log("with "+JSON.stringify(t)),navigator.bluetooth.requestDevice(t).then(t=>(console.log("> Name:             "+t.name),console.log("> Id:               "+t.id),t.addEventListener("gattserverdisconnected",this.onDisconnectCallback),t.gatt.connect())).then(t=>(this.onConnectCallback(),console.log("Getting Services..."),t.getPrimaryServices())).then(t=>{console.log("Getting Characteristics...");let e=Promise.resolve();return t.forEach(t=>{e=e.then(e=>t.getCharacteristics().then(e=>{console.log("> Service: "+t.uuid),e.forEach(t=>{switch(console.log(">> Characteristic: "+t.uuid+" "+C(t)),t.uuid){case"e95d8d00-251d-470a-a062-fa1922dfa9a8":this.characteristic.IO_PIN_DATA=t;break;case"e95d5899-251d-470a-a062-fa1922dfa9a8":this.characteristic.IO_AD_CONFIG=t;break;case"e95db9fe-251d-470a-a062-fa1922dfa9a8":this.characteristic.IO_PIN_CONFIG=t;break;case"e95dd822-251d-470a-a062-fa1922dfa9a8":this.characteristic.IO_PIN_PWM=t;break;case"e95d7b77-251d-470a-a062-fa1922dfa9a8":this.characteristic.LED_STATE=t,this.connected=!0;break;case"e95d93ee-251d-470a-a062-fa1922dfa9a8":this.characteristic.LED_TEXT=t;break;case"e95d0d2d-251d-470a-a062-fa1922dfa9a8":this.characteristic.LED_SCROLL=t}C(t).includes("NOTIFY")&&(t.startNotifications().catch(t=>console.log("startNotifications",t)),t.addEventListener("characteristicvaluechanged",this.characteristic_updated.bind(this)))})}))}),e}).catch(t=>{console.log("Argh! "+t)})}}function C(t){let e=[];for(const a in t.properties)!0===t.properties[a]&&e.push(a.toUpperCase());return"["+e.join(", ")+"]"}class T{constructor(t){this.context=t,this.pausedSize=1,this.axisSize=3}draw_line(t,e,a,i){this.context.strokeStyle=i,this.context.lineWidth=a,this.context.lineCap="round",this.context.lineTo(t,e),this.context.stroke(),this.context.beginPath(),this.context.moveTo(t,e)}draw_point(t,e,a,i){this.context.fillStyle=i,this.context.fillRect(t,e,a,a)}draw_axis(t,e,a,i){this.context.fillStyle="black",this.context.fillRect(0,0,a,i),this.context.fillStyle="yellow",this.context.fillRect(t,e,this.axisSize,this.axisSize)}mapValues(t,e,a,i,n){return(t-e)/(a-e)*(n-i)+i}}const{document:A,window:_}=p;function B(t){let e,a,g,v,m=(t[1]?t[9][1]:t[9][0])+"";return{c(){e=i("div"),a=i("button"),g=n(m),this.h()},l(t){e=s(t,"DIV",{class:!0});var i=c(e);a=s(i,"BUTTON",{class:!0});var n=c(a);g=o(n,m),n.forEach(r),i.forEach(r),this.h()},h(){l(a,"class","btn svelte-15wwbf5"),l(e,"class","svelte-15wwbf5"),v=d(a,"click",t[11])},m(t,i){h(t,e,i),u(e,a),u(a,g)},p(t,e){2&e&&m!==(m=(t[1]?t[9][1]:t[9][0])+"")&&f(g,m)},d(t){t&&r(e),v()}}}function x(t){let e,a;return{c(){e=i("button"),a=n("draw"),this.h()},l(t){e=s(t,"BUTTON",{class:!0});var i=c(e);a=o(i,"draw"),i.forEach(r),this.h()},h(){l(e,"class","btn-menu svelte-15wwbf5")},m(t,i){h(t,e,i),u(e,a)},p:m,d(t){t&&r(e)}}}function O(t){let e,a,d=t[10].line?"line":"dot";return{c(){e=i("button"),a=n(d),this.h()},l(t){e=s(t,"BUTTON",{class:!0});var i=c(e);a=o(i,d),i.forEach(r),this.h()},h(){l(e,"class","btn-menu svelte-15wwbf5")},m(t,i){h(t,e,i),u(e,a)},p:m,d(t){t&&r(e)}}}function D(t){let e,a,w,p,E,I,C,T,D,L,P,k,N,y,R,S,V,z,G,U,F,H,M,W,j,X,q,Z,J,Y,K,Q,$=t[0]&&B(t);function tt(t,e){return t[8]?O:x}let et=tt(t),at=et(t);return{c(){e=g(),a=i("div"),w=i("h1"),p=n("LZRBIT"),E=g(),$&&$.c(),I=g(),C=i("div"),T=i("div"),at.c(),D=g(),L=i("p"),P=n("x: "),k=n(t[5]),N=g(),y=i("p"),R=n("y: "),S=n(t[6]),V=g(),z=i("p"),G=n("z: "),U=n(t[7]),F=g(),H=i("button"),M=n("save"),W=g(),j=i("div"),X=i("canvas"),q=g(),Z=i("div"),J=i("div"),Y=n("[!] GO TO THE TOP RIGHT CORNER AND OPEN THE CONTROLS PANEL TO DRAW [!]"),this.h()},l(i){e=v(i),a=s(i,"DIV",{class:!0});var n=c(a);w=s(n,"H1",{class:!0});var l=c(w);p=o(l,"LZRBIT"),l.forEach(r),E=v(n),$&&$.l(n),I=v(n),C=s(n,"DIV",{class:!0});var d=c(C);T=s(d,"DIV",{class:!0});var h=c(T);at.l(h),D=v(h),L=s(h,"P",{class:!0});var u=c(L);P=o(u,"x: "),k=o(u,t[5]),u.forEach(r),N=v(h),y=s(h,"P",{class:!0});var f=c(y);R=o(f,"y: "),S=o(f,t[6]),f.forEach(r),V=v(h),z=s(h,"P",{class:!0});var g=c(z);G=o(g,"z: "),U=o(g,t[7]),g.forEach(r),F=v(h),H=s(h,"BUTTON",{class:!0});var m=c(H);M=o(m,"save"),m.forEach(r),h.forEach(r),d.forEach(r),W=v(n),j=s(n,"DIV",{hidden:!0,class:!0});var b=c(j);X=s(b,"CANVAS",{width:!0,height:!0,class:!0}),c(X).forEach(r),q=v(b),Z=s(b,"DIV",{class:!0});var A=c(Z);J=s(A,"DIV",{class:!0});var _=c(J);Y=o(_,"[!] GO TO THE TOP RIGHT CORNER AND OPEN THE CONTROLS PANEL TO DRAW [!]"),_.forEach(r),A.forEach(r),b.forEach(r),n.forEach(r),this.h()},h(){A.title="LZRBTI-APP",l(w,"class","svelte-15wwbf5"),l(L,"class","svelte-15wwbf5"),l(y,"class","svelte-15wwbf5"),l(z,"class","svelte-15wwbf5"),l(H,"class","btn-menu svelte-15wwbf5"),l(T,"class","grid-container svelte-15wwbf5"),l(C,"class","flex-container svelte-15wwbf5"),l(X,"width",t[3]),l(X,"height",t[4]),l(X,"class","svelte-15wwbf5"),l(J,"class","svelte-15wwbf5"),l(Z,"class","flex-container svelte-15wwbf5"),j.hidden=K=!t[1],l(j,"class","svelte-15wwbf5"),l(a,"class","flex-container svelte-15wwbf5"),Q=[d(_,"keydown",t[13]),d(H,"click",t[12])]},m(i,n){h(i,e,n),h(i,a,n),u(a,w),u(w,p),u(a,E),$&&$.m(a,null),u(a,I),u(a,C),u(C,T),at.m(T,null),u(T,D),u(T,L),u(L,P),u(L,k),u(T,N),u(T,y),u(y,R),u(y,S),u(T,V),u(T,z),u(z,G),u(z,U),u(T,F),u(T,H),u(H,M),u(a,W),u(a,j),u(j,X),t[17](X),u(j,q),u(j,Z),u(Z,J),u(J,Y)},p(t,[e]){t[0]?$?$.p(t,e):($=B(t),$.c(),$.m(a,I)):$&&($.d(1),$=null),et===(et=tt(t))&&at?at.p(t,e):(at.d(1),at=et(t),at&&(at.c(),at.m(T,D))),32&e&&f(k,t[5]),64&e&&f(S,t[6]),128&e&&f(U,t[7]),8&e&&l(X,"width",t[3]),16&e&&l(X,"height",t[4]),2&e&&K!==(K=!t[1])&&(j.hidden=K)},i:m,o:m,d(i){i&&r(e),i&&r(a),$&&$.d(),at.d(),t[17](null),b(Q)}}}function L(t,e,a){let i,n,s,c,o,r,l=!0,d=!1,h=new I,u=0,f=0,g=0,v={drawing:!1,name:"Brush Parameters",line:!1,sizeLine:.1,colorLine:"#9acd32",point:!1,sizePoint:1,colorPoint:"#ff6347",save(){const t=document.createElement("a");document.body.appendChild(t),t.href=i.toDataURL("image/png",1),t.download="canvas-image.png",t.click(),document.body.removeChild(t)}};return w(()=>{import("./dat.gui.module.83faae46.js").then(t=>{let e=new t.GUI;!1===d&&(e.closed=!0);e.addFolder("Line");e.add(v,"line"),e.add(v,"sizeLine",0,2,.1),e.addColor(v,"colorLine");e.addFolder("Point");e.add(v,"point"),e.add(v,"sizePoint",0,2,.1),e.addColor(v,"colorPoint"),e.add(v,"save")}),a(3,s=window.innerWidth),a(4,c=window.innerHeight),n=i.getContext("2d");let t=new T(n);n.imageSmoothingEnabled=!0,function e(){if(n.globalCompositeOperation="lighter",d)if(!0===v.line){n.fillStyle="black",n.fillRect(0,0,s,c);let e=t.mapValues(u,-1024,1024,0,s),a=t.mapValues(f,-1024,1024,0,c);t.draw_line(e,a,v.sizeLine,v.colorLine)}else if(!0===v.point){n.fillStyle="black",n.fillRect(0,0,s,c);let e=t.mapValues(u,-1024,1024,0,s),a=t.mapValues(f,-1024,1024,0,c);t.draw_point(e,a,v.sizePoint,v.colorPoint),n.beginPath()}else if(!0===v.line&&!0===v.point){n.fillStyle="black",n.fillRect(0,0,s,c);let e=t.mapValues(u,-1024,1024,0,s),a=t.mapValues(f,-1024,1024,0,c);t.draw_line(e,a,v.sizeLine,v.colorLine),t.draw_point(e,a,v.sizePoint,v.colorPoint)}else if(" "===r){n.clearRect(0,0,s,c);let e=t.mapValues(u,-1024,1024,0,s),a=t.mapValues(f,-1024,1024,0,c);t.draw_axis(e,a,s,c)}else{n.clearRect(0,0,s,c);let e=t.mapValues(u,-1024,1024,0,s),a=t.mapValues(f,-1024,1024,0,c);t.draw_axis(e,a,s,c)}o=requestAnimationFrame(e)}()}),[l,d,i,s,c,u,f,g,r,["PAIR MICROBIT","PAIRED"],v,function(){h.searchDevice(),h.onConnect(()=>{console.log("connected"),a(1,d=!0),console.log("pared: true")}),h.onBleNotify((function(){a(5,u=h.getAccelerometer().x),a(6,f=h.getAccelerometer().y),a(7,g=h.getAccelerometer().z)})),a(0,l=!1)},function(){console.log("saveDrawing");const t=document.createElement("a");document.body.appendChild(t),t.href=i.toDataURL("image/png",1),t.download="canvas-image.png",t.click(),document.body.removeChild(t)},function(t){a(8,r=t.key)},n,o,h,function(t){E[t?"unshift":"push"](()=>{a(2,i=t)})}]}export default class extends t{constructor(t){super(),e(this,t,L,D,a,{})}}
