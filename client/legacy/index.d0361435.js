import{Q as t,b as e,a,c as n,d as i,i as c,s as o,e as s,S as r,f as l,t as u,h,j as f,k as d,l as v,o as g,R as k,q as m,r as b,D as p,g as y,m as I,n as w,T as C,N as _,U as B,V as E}from"./index.3e479b87.js";import{_ as A}from"./slicedToArray.f13a096f.js";import"./index.eca9e3b4.js";var x=function(){function a(){e(this,a),this.accelerometer={x:0,y:0,z:0},this.magnetometer_raw={x:0,y:0,z:0},this.magnetometer_bearing=0,this.temperature=0,this.buttonA=0,this.buttonACallBack=function(){},this.buttonB=0,this.buttonBCallBack=function(){},this.connected=!1,this.onConnectCallback=function(){},this.onDisconnectCallback=function(){},this.onBLENotifyCallback=function(){},this.characteristic={IO_PIN_DATA:{},IO_AD_CONFIG:{},IO_PIN_CONFIG:{},IO_PIN_PWM:{},LED_STATE:{},LED_TEXT:{},LED_SCROLL:{}}}return t(a,[{key:"getTemperature",value:function(){return this.temperature}},{key:"getAccelerometer",value:function(){return this.accelerometer}},{key:"getBearing",value:function(){return this.magnetometer_bearing}},{key:"getButtonA",value:function(){return this.buttonA}},{key:"setButtonACallback",value:function(t){this.buttonACallBack=t}},{key:"getButtonB",value:function(){return this.buttonB}},{key:"setButtonBCallback",value:function(t){this.buttonBCallBack=t}},{key:"onConnect",value:function(t){this.onConnectCallback=t}},{key:"onDisconnect",value:function(t){this.onDisconnectCallback=t}},{key:"onBleNotify",value:function(t){this.onBLENotifyCallback=t}},{key:"writePin",value:function(t){}},{key:"readPin",value:function(t){}},{key:"writeMatrixIcon",value:function(t){for(var e=new Int8Array(5),a=[["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0"]],n=0;n<5;n++)for(var i=0;i<5;i++)a[n][7-i]=t[n][4-i];for(n=0;n<5;n++){var c=a[n].join("");e[n]=parseInt(c,2)}this.connected&&this.characteristic.LED_STATE.writeValue(e).then(function(t){}).catch(function(t){console.log(t)})}},{key:"writeMatrixTextSpeed",value:function(t){var e=new Uint8Array(t);this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(function(t){}).catch(function(t){console.log(t)})}},{key:"writeMatrixText",value:function(t){var e=new Uint8Array(function(t){for(var e=[],a=0;a<t.length;a++){var n=t.charCodeAt(a);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|63&n):(a++,n=65536+((1023&n)<<10|1023&t.charCodeAt(a)),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return e}(t));this.connected&&this.characteristic.LED_TEXT.writeValue(e).then(function(t){}).catch(function(t){console.log(t)})}},{key:"onButtonA",value:function(){this.buttonACallBack()}},{key:"onButtonB",value:function(){this.buttonBCallBack()}},{key:"characteristic_updated",value:function(t){this.onBLENotifyCallback(),"e95dda90-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.buttonA=t.target.value.getInt8(),this.buttonA&&this.onButtonA()),"e95dda91-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.buttonB=t.target.value.getInt8(),this.buttonB&&this.onButtonB()),"e95dca4b-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.accelerometer.x=t.target.value.getInt16(0,!0),this.accelerometer.y=t.target.value.getInt16(2,!0),this.accelerometer.z=t.target.value.getInt16(4,!0)),"e95dfb11-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.magnetometer_raw.x=t.target.value.getInt16(0,!0),this.magnetometer_raw.y=t.target.value.getInt16(2,!0),this.magnetometer_raw.z=t.target.value.getInt16(4,!0)),"e95d9715-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.magnetometer_bearing=t.target.value.getInt16(0,!0)),"e95d9250-251d-470a-a062-fa1922dfa9a8"==t.target.uuid&&(this.temperature=t.target.value.getInt8())}},{key:"searchDevice",value:function(){var t=this,e={acceptAllDevices:!0,optionalServices:["e95d0753-251d-470a-a062-fa1922dfa9a8","e95df2d8-251d-470a-a062-fa1922dfa9a8","e95d9882-251d-470a-a062-fa1922dfa9a8","e95d127b-251d-470a-a062-fa1922dfa9a8","e95dd91d-251d-470a-a062-fa1922dfa9a8","e95d6100-251d-470a-a062-fa1922dfa9a8"]};console.log("Requesting Bluetooth Device..."),console.log("with "+JSON.stringify(e)),navigator.bluetooth.requestDevice(e).then(function(e){return console.log("> Name:             "+e.name),console.log("> Id:               "+e.id),e.addEventListener("gattserverdisconnected",t.onDisconnectCallback),e.gatt.connect()}).then(function(e){return t.onConnectCallback(),console.log("Getting Services..."),e.getPrimaryServices()}).then(function(e){console.log("Getting Characteristics...");var a=Promise.resolve();return e.forEach(function(e){a=a.then(function(a){return e.getCharacteristics().then(function(a){console.log("> Service: "+e.uuid),a.forEach(function(e){switch(console.log(">> Characteristic: "+e.uuid+" "+T(e)),e.uuid){case"e95d8d00-251d-470a-a062-fa1922dfa9a8":t.characteristic.IO_PIN_DATA=e;break;case"e95d5899-251d-470a-a062-fa1922dfa9a8":t.characteristic.IO_AD_CONFIG=e;break;case"e95db9fe-251d-470a-a062-fa1922dfa9a8":t.characteristic.IO_PIN_CONFIG=e;break;case"e95dd822-251d-470a-a062-fa1922dfa9a8":t.characteristic.IO_PIN_PWM=e;break;case"e95d7b77-251d-470a-a062-fa1922dfa9a8":t.characteristic.LED_STATE=e,t.connected=!0;break;case"e95d93ee-251d-470a-a062-fa1922dfa9a8":t.characteristic.LED_TEXT=e;break;case"e95d0d2d-251d-470a-a062-fa1922dfa9a8":t.characteristic.LED_SCROLL=e}T(e).includes("NOTIFY")&&(e.startNotifications().catch(function(t){return console.log("startNotifications",t)}),e.addEventListener("characteristicvaluechanged",t.characteristic_updated.bind(t)))})})})}),a}).catch(function(t){console.log("Argh! "+t)})}}]),a}();function T(t){var e=[];for(var a in t.properties)!0===t.properties[a]&&e.push(a.toUpperCase());return"["+e.join(", ")+"]"}var D=function(){function a(t){e(this,a),this.context=t,this.pausedSize=1,this.axisSize=3}return t(a,[{key:"draw_line",value:function(t,e,a){this.context.strokeStyle="greenyellow",this.context.lineWidth=a,this.context.lineCap="round",this.context.lineTo(t,e),this.context.stroke(),this.context.beginPath(),this.context.moveTo(t,e)}},{key:"draw_point",value:function(t,e){this.context.fillStyle="yellow",this.context.fillRect(t,e,this.pausedSize,this.pausedSize)}},{key:"draw_axis",value:function(t,e,a,n){this.context.fillStyle="black",this.context.fillRect(0,0,a,n),this.context.fillStyle="yellow",this.context.fillRect(t,e,this.axisSize,this.axisSize)}},{key:"mapValues",value:function(t,e,a,n,i){return(t-e)/(a-e)*(i-n)+n}}]),a}(),N=B.document,S=B.window;function L(t){var e,a,n,i,c=(t[1]?t[9][1]:t[9][0])+"";return{c:function(){e=l("div"),a=l("button"),n=u(c),this.h()},l:function(t){e=h(t,"DIV",{class:!0});var i=f(e);a=h(i,"BUTTON",{class:!0});var o=f(a);n=d(o,c),o.forEach(v),i.forEach(v),this.h()},h:function(){g(a,"class","btn svelte-krsuh1"),g(e,"class","svelte-krsuh1"),i=k(a,"click",t[10])},m:function(t,i){m(t,e,i),b(e,a),b(a,n)},p:function(t,e){2&e&&c!==(c=(t[1]?t[9][1]:t[9][0])+"")&&p(n,c)},d:function(t){t&&v(e),i()}}}function O(t){var e,a;return{c:function(){e=l("button"),a=u("draw"),this.h()},l:function(t){e=h(t,"BUTTON",{class:!0});var n=f(e);a=d(n,"draw"),n.forEach(v),this.h()},h:function(){g(e,"class","btn-menu svelte-krsuh1")},m:function(t,n){m(t,e,n),b(e,a)},p:w,d:function(t){t&&v(e)}}}function P(t){var e,a,n="l"===t[8]?"line":"dot";return{c:function(){e=l("button"),a=u(n),this.h()},l:function(t){e=h(t,"BUTTON",{class:!0});var i=f(e);a=d(i,n),i.forEach(v),this.h()},h:function(){g(e,"class","btn-menu svelte-krsuh1")},m:function(t,n){m(t,e,n),b(e,a)},p:function(t,e){256&e&&n!==(n="l"===t[8]?"line":"dot")&&p(a,n)},d:function(t){t&&v(e)}}}function R(t){var e,a,n,i,c,o,s,r,_,B,E,x,T,D,R,V,z,U,j,F,G,M,q,W,X,Z,H,J,Q=t[0]&&L(t);function Y(t,e){return t[8]?P:O}var K=Y(t),$=K(t);return{c:function(){e=y(),a=l("div"),n=l("h1"),i=u("LZRBIT"),c=y(),Q&&Q.c(),o=y(),s=l("div"),r=l("div"),$.c(),_=y(),B=l("p"),E=u("x: "),x=u(t[5]),T=y(),D=l("p"),R=u("y: "),V=u(t[6]),z=y(),U=l("p"),j=u("z: "),F=u(t[7]),G=y(),M=l("button"),q=u("save"),W=y(),X=l("div"),Z=l("canvas"),this.h()},l:function(l){e=I(l),a=h(l,"DIV",{class:!0});var u=f(a);n=h(u,"H1",{class:!0});var g=f(n);i=d(g,"LZRBIT"),g.forEach(v),c=I(u),Q&&Q.l(u),o=I(u),s=h(u,"DIV",{class:!0});var k=f(s);r=h(k,"DIV",{class:!0});var m=f(r);$.l(m),_=I(m),B=h(m,"P",{class:!0});var b=f(B);E=d(b,"x: "),x=d(b,t[5]),b.forEach(v),T=I(m),D=h(m,"P",{class:!0});var p=f(D);R=d(p,"y: "),V=d(p,t[6]),p.forEach(v),z=I(m),U=h(m,"P",{class:!0});var y=f(U);j=d(y,"z: "),F=d(y,t[7]),y.forEach(v),G=I(m),M=h(m,"BUTTON",{class:!0});var w=f(M);q=d(w,"save"),w.forEach(v),m.forEach(v),k.forEach(v),W=I(u),X=h(u,"DIV",{hidden:!0,class:!0});var C=f(X);Z=h(C,"CANVAS",{width:!0,height:!0,class:!0}),f(Z).forEach(v),C.forEach(v),u.forEach(v),this.h()},h:function(){N.title="LZRBTI-APP",g(n,"class","svelte-krsuh1"),g(B,"class","svelte-krsuh1"),g(D,"class","svelte-krsuh1"),g(U,"class","svelte-krsuh1"),g(M,"class","btn-menu svelte-krsuh1"),g(r,"class","grid-container svelte-krsuh1"),g(s,"class","flex-container svelte-krsuh1"),g(Z,"width",t[3]),g(Z,"height",t[4]),g(Z,"class","svelte-krsuh1"),X.hidden=H=!t[1],g(X,"class","svelte-krsuh1"),g(a,"class","flex-container svelte-krsuh1"),J=[k(S,"keydown",t[12]),k(M,"click",t[11])]},m:function(l,u){m(l,e,u),m(l,a,u),b(a,n),b(n,i),b(a,c),Q&&Q.m(a,null),b(a,o),b(a,s),b(s,r),$.m(r,null),b(r,_),b(r,B),b(B,E),b(B,x),b(r,T),b(r,D),b(D,R),b(D,V),b(r,z),b(r,U),b(U,j),b(U,F),b(r,G),b(r,M),b(M,q),b(a,W),b(a,X),b(X,Z),t[16](Z)},p:function(t,e){var n=A(e,1)[0];t[0]?Q?Q.p(t,n):((Q=L(t)).c(),Q.m(a,o)):Q&&(Q.d(1),Q=null),K===(K=Y(t))&&$?$.p(t,n):($.d(1),($=K(t))&&($.c(),$.m(r,_))),32&n&&p(x,t[5]),64&n&&p(V,t[6]),128&n&&p(F,t[7]),8&n&&g(Z,"width",t[3]),16&n&&g(Z,"height",t[4]),2&n&&H!==(H=!t[1])&&(X.hidden=H)},i:w,o:w,d:function(n){n&&v(e),n&&v(a),Q&&Q.d(),$.d(),t[16](null),C(J)}}}function V(t,e,a){var n,i,c,o,s,r,l=!0,u=!1,h=new x,f=0,d=0,v=0;return _(function(){a(3,c=window.innerWidth),a(4,o=window.innerHeight),i=n.getContext("2d");var t=new D(i);!function e(){if(i.globalCompositeOperation="lighter",u)if("q"===r){i.fillStyle="black",i.fillRect(0,0,c,o);var a=t.mapValues(f,-1024,1024,0,c),n=t.mapValues(d,-1024,1024,0,o);t.draw_line(a,n,0,1)}else if("w"===r){i.fillStyle="black",i.fillRect(0,0,c,o);var l=t.mapValues(f,-1024,1024,0,c),h=t.mapValues(d,-1024,1024,0,o);t.draw_point(l,h),i.beginPath()}else if(" "===r){i.clearRect(0,0,c,o);var v=t.mapValues(f,-1024,1024,0,c),g=t.mapValues(d,-1024,1024,0,o);t.draw_axis(v,g,c,o)}else i.fillStyle="black",i.fillRect(0,0,c,o);s=requestAnimationFrame(e)}()}),[l,u,n,c,o,f,d,v,r,["PAIR MICROBIT","PAIRED"],function(){h.searchDevice(),h.onConnect(function(){console.log("connected"),a(1,u=!0),console.log("pared: true")}),h.onBleNotify(function(){a(5,f=h.getAccelerometer().x),a(6,d=h.getAccelerometer().y),a(7,v=h.getAccelerometer().z)}),a(0,l=!1)},function(){console.log("saveDrawing");var t=document.createElement("a");document.body.appendChild(t),t.href=n.toDataURL("image/png",1),t.download="canvas-image.png",t.click(),document.body.removeChild(t)},function(t){a(8,r=t.key)},i,s,h,function(t){E[t?"unshift":"push"](function(){a(2,n=t)})}]}export default(function(t){function l(t){var a;return e(this,l),a=n(this,i(l).call(this)),c(s(a),t,V,R,o,{}),a}return a(l,r),l}());
